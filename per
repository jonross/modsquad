# vim:ft=python

import sys
import tavolino as tl

columns, rest = tl.getargs(tl.columns())

rows = list(tl.getrows())
if not rows:
    sys.exit(0)

offset = 0
for index in range(0, len(rows[0])):
    if index in columns or (rest is not None and index >= rest):
        values = [float(row[index + offset]) for row in rows]
        total = sum(values)
        if total > 0:
            percents = [value / total * 100 for value in values]
        else:
            percents = [0 for value in values]
        for row, percent in zip(rows, percents):
            row.insert(index + offset + 1, percent)
        offset += 1

for row in rows:
    tl.output(row)

